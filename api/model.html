<!DOCTYPE html>
<html lang="en-us">
    <head>
        <meta charset="UTF-8">
        <title>ifnode - Excellent Node.js Framework</title>
        <meta name="viewport" content="width=device-width,initial-scale=1">
        <meta name="description" content="The ifnode is a simple, flexible, super-light and pluginnable node.js framework. Allows to start developing of application right after of module install.">
        <link rel="stylesheet" type="text/css" href="/assets/css/open-sans.css?v=1.7.0" media="screen">
        <link rel="stylesheet" type="text/css" href="/assets/css/prism-default.css?v=1.7.0" media="screen">
        <link rel="stylesheet" type="text/css" href="/assets/css/normalize.css?v=1.7.0" media="screen">
        <link rel="stylesheet" type="text/css" href="/assets/css/main.css?v=1.7.0" media="screen">
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-58324359-1"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', 'UA-58324359-1');
        </script>
    </head>
    <body>
        <header class="page-header">
            <div class="project-name">
                <a href="/">ifnode</a>
            </div>
            <div class="project-tagline">Simple, flexible, super-light and pluginnable framework</div>
            <div class="project-buttons">
                <a href="https://github.com/ifnode/ifnode" class="btn">View on GitHub</a>
            </div>
        </header>
        <main class="main main--m docs">
            <aside id="toc">
    <ul>
<li><a href="/docs">Guide</a><ul>
<li><a href="/docs/intro">Introduction</a><ul>
<li><a href="/docs/intro/ideology">Ideology</a></li>
</ul>
</li>
<li><a href="/docs/install">Install</a></li>
<li><a href="/docs/app">Application Items</a><ul>
<li><a href="/docs/app/structure">Structure</a></li>
<li><a href="/docs/app/file">app.js</a></li>
<li><a href="/docs/app/config">Config</a><ul>
<li><a href="/docs/app/config/default">Default config</a></li>
<li><a href="/docs/app/config/middleware">Middleware</a></li>
</ul>
</li>
<li><a href="/docs/app/extensions">Extensions</a></li>
<li><a href="/docs/app/models">Models</a></li>
<li><a href="/docs/app/components">Components</a></li>
<li><a href="/docs/app/controllers">Controllers</a></li>
<li><a href="/docs/app/plugins">Plugins</a><ul>
<li><a href="/docs/app/plugins/component">component</a></li>
<li><a href="/docs/app/plugins/controller">controller</a></li>
<li><a href="/docs/app/plugins/schema">schema</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="/api">API</a><ul>
<li>Constants<ul>
<li><a href="/api/plugin_types">PLUGIN_TYPES</a><ul>
<li><a href="/api/plugin_types#schema">.SCHEMA</a></li>
<li><a href="/api/plugin_types#component">.COMPONENT</a></li>
<li><a href="/api/plugin_types#controller">.CONTROLLER</a></li>
</ul>
</li>
</ul>
</li>
<li>Interfaces<ul>
<li><a href="/api/iconnectionserver">IConnectionServer</a><ul>
<li><a href="/api/iconnectionserver#iconnectionserver-constructor">#constructor</a></li>
<li><a href="/api/iconnectionserver#iconnectionserver-configure">#configure</a></li>
<li><a href="/api/iconnectionserver#iconnectionserver-listen">#listen</a></li>
<li><a href="/api/iconnectionserver#iconnectionserver-close">#close</a></li>
</ul>
</li>
</ul>
</li>
<li>Classes<ul>
<li><a href="/api/ifnode">IFNode</a></li>
<li><a href="/api/application">Application</a><ul>
<li><a href="/api/application#application-constructor">Constructor</a></li>
<li>Properties<ul>
<li><a href="/api/application#application-id">.id</a></li>
<li><a href="/api/application#application-alias">.alias</a></li>
<li><a href="/api/application#application-project_folder">.project_folder</a></li>
<li><a href="/api/application#application-project_folder">.projectFolder</a></li>
<li><a href="/api/application#application-backend_folder">.backend_folder</a></li>
<li><a href="/api/application#application-backend_folder">.backendFolder</a></li>
<li><a href="/api/application#application-config">.config</a></li>
<li><a href="/api/application#application-listener">.listener</a></li>
<li><a href="/api/application#application-connection">.connection</a></li>
<li><em><a href="/api/application#application-server">.server <sup>deprecated</sup></a></em></li>
<li><a href="/api/application#application-models">.models</a></li>
<li><a href="/api/application#application-components">.components</a></li>
<li><a href="/api/application#application-controllers">.controllers</a></li>
</ul>
</li>
<li>Methods<ul>
<li><a href="/api/application#application-require">.require</a></li>
<li><a href="/api/application#application-register">.register</a></li>
<li><a href="/api/application#application-load">.load</a></li>
<li><a href="/api/application#application-extension">.extension</a></li>
<li><em><a href="/api/application#application-extension">.ext <sup>deprecated</sup></a></em></li>
<li><a href="/api/application#application-component">.component</a></li>
<li><em><a href="/api/application#application-run">.run <sup>deprecated</sup></a></em></li>
<li><em><a href="/api/application#application-down">.down <sup>deprecated</sup></a></em></li>
<li><a href="/api/application#application-model-class">.Model</a></li>
<li><em><a href="/api/application#application-component-class">.Component <sup>deprecated</sup></a></em></li>
<li><a href="/api/application#application-controller-class">.Controller</a></li>
</ul>
</li>
</ul>
</li>
<li><strong>Model</strong><ul>
<li><a href="/api/model#model-constructor">Constructor</a></li>
</ul>
</li>
<li><a href="/api/component">Component</a><ul>
<li><a href="/api/component#component-constructor">Constructor</a></li>
<li>Properties<ul>
<li><a href="/api/component#component-id">.id</a></li>
<li><a href="/api/component#component-name">.name</a></li>
<li><a href="/api/component#component-config">.config</a></li>
<li><a href="/api/component#component-alias">.alias</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="/api/controller">Controller</a><ul>
<li>Static methods<ul>
<li><a href="/api/controller#process_config">.process_config</a></li>
<li><a href="/api/controller#process_config">.processConfig</a></li>
<li><a href="/api/controller#populate">.populate</a></li>
<li><a href="/api/controller#middleware">.middleware</a></li>
</ul>
</li>
<li><a href="/api/controller#constructor">Constructor</a></li>
<li>Properties<ul>
<li><a href="/api/controller#controller-id">.id</a></li>
<li><a href="/api/controller#controller-name">.name</a></li>
<li><a href="/api/controller#controller-root">.root</a></li>
<li><a href="/api/controller#controller-router">.router</a></li>
<li><a href="/api/controller#controller-map">.map</a></li>
</ul>
</li>
<li>Methods<ul>
<li><a href="/api/controller#before">.before</a></li>
<li><a href="/api/controller#param">.param</a></li>
<li><a href="/api/controller#method">.method</a></li>
<li><a href="/api/controller#method-get">.get</a></li>
<li><a href="/api/controller#method-post">.post</a></li>
<li><a href="/api/controller#method-put">.put</a></li>
<li><a href="/api/controller#method-patch">.patch</a></li>
<li><a href="/api/controller#method-delete">.delete</a></li>
<li><em><a href="/api/controller#method-del">.del <sup>deprecated</sup></a></em></li>
<li><a href="/api/controller#use">.use</a></li>
<li><a href="/api/controller#end">.end</a></li>
<li><a href="/api/controller#error">.error</a></li>
</ul>
</li>
<li>Request property<ul>
<li><a href="/api/controller#request-data">req.data</a></li>
</ul>
</li>
<li>Response methods<ul>
<li><a href="/api/controller#response-ok">res.ok</a></li>
<li><a href="/api/controller#response-bad_request">res.bad_request</a></li>
<li><a href="/api/controller#response-bad_request">res.badRequest</a></li>
<li><a href="/api/controller#response-bad_request">res.fail</a></li>
<li><a href="/api/controller#response-unauthorized">res.unauthorized</a></li>
<li><a href="/api/controller#response-forbidden">res.forbidden</a></li>
<li><a href="/api/controller#response-not_found">res.not_found</a></li>
<li><a href="/api/controller#response-not_found">res.notFound</a></li>
<li><a href="/api/controller#response-error">res.error</a></li>
<li><a href="/api/controller#response-error">res.err</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

</aside>
<section id="docs">
    <h1 id="model">Model <a href="#model"><span>#</span></a></h1>
<h2 id="description">Description <a href="#description"><span>#</span></a></h2>
<p>Model is a presentation of <a href="/docs/app/#models"><strong>Data Access Layer</strong></a> on <code>ifnode</code> architecture and is a other core part in <code>ifnode</code> application. 
<code>Model</code> must be presented by some &quot;mediator&quot; (or <code>Schema</code> by <code>ifnode</code>&#39;s terminology) between <code>ifnode</code> application and external data access module.</p>
<p><code>Schema</code> can be <code>npm</code> module 
(like <a href="https://npmjs.com/package/ifnode-mongoose"><code>ifnode-mongoose</code></a>) or can be own application <code>Schema</code> which placed in <code>extensions</code> folder (f.e <a href="#my-knex-mediator"><code>my-knex-mediator</code></a>). 
Also <code>ifnode</code> has <a href="https://github.com/ifnode/ifnode/blob/master/plugins/ifnode-virtual/index.js"><code>virtual</code></a> schema which is default for any model.</p>
<p>More about <code>ifnode</code> models you can read <strong><a href="/docs/app/models">here</a></strong></p>
<h2 id="definition">Definition <a href="#definition"><span>#</span></a></h2>
<h3 id="typescript-syntax">TypeScript syntax <a href="#typescript-syntax"><span>#</span></a></h3>
<pre><code class="lang-typescript"><span class="token keyword">interface</span> <span class="token class-name">Model</span> <span class="token punctuation">{</span>
    <span class="token keyword">new</span> <span class="token punctuation">(</span>model_options<span class="token punctuation">:</span> Object<span class="token punctuation">,</span> db_options<span class="token operator">?</span><span class="token punctuation">:</span> Object<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="model-constructor">Model#constructor( model_options [, db_options] ) <a href="#model-constructor"><span>#</span></a></h2>
<h3 id="arguments">Arguments <a href="#arguments"><span>#</span></a></h3>
<h4 id="model_options">model_options <a href="#model_options"><span>#</span></a></h4>
<p>Options to create model instance. All options are specified by model&#39;s <code>Schema</code>. Example of <code>model_options</code> you can find on 
<a href="https://www.npmjs.com/package/ifnode-mongoose#model_options-required"><code>ifnode-mongoose</code></a> module.</p>
<h4 id="db_options">db_options <a href="#db_options"><span>#</span></a></h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>db</code></td>
<td><code>string</code></td>
<td>Set data connection from application configuration. It&#39;s one of application&#39;s connectors names (from <a href="/docs/app/config/#db"><code>app.config.db</code></a>) or default <code>virtual</code></td>
</tr>
<tr>
<td><code>alias</code></td>
<td><code>string</code>, <code>Array&lt;string&gt;</code></td>
<td>Aliases of model. They will be attached to <code>app.models</code></td>
</tr>
</tbody>
</table>
<h2 id="create-own-schema">Create own Schema <a href="#create-own-schema"><span>#</span></a></h2>
<p><code>Schema</code> can be created by exporting special method <code>schema</code> from module. Method has two arguments <code>app</code> and <code>Schema</code>.</p>
<p><code>app</code> is an instance of current application, <code>Schema</code> is class for creating model instances and it must to be extended</p>
<h3 id="schema-class">Schema class <a href="#schema-class"><span>#</span></a></h3>
<p><code>Schema</code> has predefined methods and properties. Below list of them.</p>
<h4 id="static-properties-and-methods">Static properties and methods <a href="#static-properties-and-methods"><span>#</span></a></h4>
<p><em>Note: <strong>required</strong> mark means that method or setter must to be realized or set, <strong>optional</strong> is not required for definiton</em></p>
<h4 id="schema-schema-">Schema.schema (required) <a href="#schema-schema"><span>#</span></a></h4>
<p>It is a setter property and it name of the <code>Schema</code>. Name must to be set.</p>
<p>Name is used by <a href="/docs/app/config/#db"><code>db</code></a> configuration (<code>schema</code> option) for picking required <code>Schema</code>.</p>
<h4 id="schema-driver-">Schema.driver( config ) (optional) <a href="#schema-driver"><span>#</span></a></h4>
<p>Method is used by setting up <code>Schema</code>&#39;s driver. Driver can be presented by some <code>npm</code> or internal module. Argument <code>config</code> 
gets from <a href="/docs/app/config/#db"><code>db</code></a> configuration (<code>config</code> option).</p>
<h4 id="instance-properties-and-methods">Instance properties and methods <a href="#instance-properties-and-methods"><span>#</span></a></h4>
<h5 id="property">Property <a href="#property"><span>#</span></a></h5>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>_driver</code></td>
<td><code>any</code></td>
<td>Driver instance. There is same as returned value from static <code>driver</code> method</td>
</tr>
</tbody>
</table>
<p><em>Note: <code>_driver</code> will be attached automatically to instance by <code>ifnode</code></em></p>
<h5 id="methods">Methods <a href="#methods"><span>#</span></a></h5>
<p><em>Note: methods must to be defined across <code>prototype</code> property</em></p>
<h6 id="schema-initialize-">Schema#initialize( model_config ) (required) <a href="#schema-initialize"><span>#</span></a></h6>
<p>Method of creating model instance which will be returned by <code>app.Model</code>. Argument <code>model_config</code> is first argument of 
<code>app.Model</code> invoking.</p>
<p><strong><em>Aliases:</em></strong></p>
<ul>
<li><code>Schema#init( model_config )</code></li>
</ul>
<h6 id="schema-compile-">Schema#compile() (required) <a href="#schema-compile"><span>#</span></a></h6>
<p>Building of final model instance which will be attached to <code>app.models</code>.</p>
<h5 id="example-of-usage">Example of usage <a href="#example-of-usage"><span>#</span></a></h5>
<pre><code class="lang-javascript"><span class="token comment" spellcheck="true">// own-schema.js</span>
exports<span class="token punctuation">.</span>schema <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span> Schema<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Schema<span class="token punctuation">.</span>schema <span class="token operator">=</span> <span class="token string">'name-of-schema'</span><span class="token punctuation">;</span>
    Schema<span class="token punctuation">.</span>driver <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>db_config<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// driver initialize</span>
        <span class="token keyword">return</span> <span class="token function">SomeDriverFactory</span><span class="token punctuation">(</span>db_config<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    Schema<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>initialize <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>model_config<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// model instance initialize</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>data_accessor <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_driver</span><span class="token punctuation">(</span>model_config<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    Schema<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>compile <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// returns model instance which accessed by app.models[name]</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<h5 id="my-knex-mediator">My Knex Mediator <a href="#my-knex-mediator"><span>#</span></a></h5>
<p>Simple schema to provide connection between <code>knex</code> module and <code>ifnode</code> application:</p>
<pre><code class="lang-javascript"><span class="token comment" spellcheck="true">// protected/extensions/my-knex-mediator.js</span>
<span class="token string">'use strict'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Knex <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'knex'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

exports<span class="token punctuation">.</span>schema <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span> KnexSchema<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    KnexSchema<span class="token punctuation">.</span>schema <span class="token operator">=</span> <span class="token string">'my-knex-mediator'</span><span class="token punctuation">;</span>
    KnexSchema<span class="token punctuation">.</span>driver <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>db_config<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">Knex</span><span class="token punctuation">(</span>db_config<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    KnexSchema<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>initialize <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>model_config<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>table <span class="token operator">=</span> model_config<span class="token punctuation">.</span>table<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>driver <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_driver<span class="token punctuation">;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>all <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">driver</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>table<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    KnexSchema<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>compile <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>

</section>
<section id="toc-page">
    <a href="/toc">Table of Content</a>
</section>

        </main>
        <footer class="page-footer">
            <span class="owner">
                <a href="https://github.com/ifnode/ifnode">ifnode</a> is maintained by <a href="https://github.com/ilfroloff">Ilya Frolov</a> ©
            </span>
        </footer>
    </body>
</html>
